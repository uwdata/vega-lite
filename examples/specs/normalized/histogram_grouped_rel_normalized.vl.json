{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {"url": "https://vega.github.io/editor/data/cars.json"},
  "transform": [
    {
      "aggregate": [{"op": "count", "as": "Count"}],
      "groupby": ["Cylinders", "Origin"]
    },
    {
      "joinaggregate": [{"op": "sum", "field": "Count", "as": "OriginCount"}],
      "groupby": ["Origin"]
    },
    {"calculate": "datum.Count/datum.OriginCount", "as": "PercentOfOrigin"}
  ],
  "config": {"view": {"stroke": "transparent"}, "axis": {"domainWidth": 1}},
  "spacing": {"column": -2},
  "facet": {
    "column": {
      "field": "Cylinders",
      "type": "nominal",
      "header": {"titleOrient": "bottom", "labelOrient": "bottom"}
    }
  },
  "spec": {
    "width": 100,
    "mark": {"type": "bar", "tooltip": true},
    "encoding": {
      "x": {
        "field": "Origin",
        "type": "nominal",
        "title": null,
        "axis": {"labels": false, "ticks": false}
      },
      "y": {
        "field": "PercentOfOrigin",
        "type": "quantitative",
        "axis": {"title": "Relative Frequency (per Origin)", "format": "0.1~%"}
      },
      "color": {"field": "Origin", "type": "nominal"}
    }
  }
}